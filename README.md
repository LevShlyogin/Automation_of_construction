# Проект автоматизации расчёта штоков клапанов

## Описание проекта

Проект представляет собой веб-приложение, предназначенное для автоматизации расчётов штоков клапанов на основе данных из базы данных и введённых пользователем параметров. Программа выполняет поиск чертежей клапанов по названию турбины, анализирует данные о клапанах и рассчитывает параметры пара и воздуха для каждого участка клапана. Проект использует базу данных PostgreSQL для хранения информации о турбинах и чертежах, а также библиотеки для работы с таблицами и выполнения термодинамических расчётов.

## Функциональность

- Поиск чертежей клапанов по названию турбины.
- Вывод информации о найденных чертежах.
- Расчёт параметров пара и воздуха для каждого участка клапана на основе введённых данных.
- Поддержка расчётов для различных типов турбин и клапанов с разным количеством участков.
- Автоматизированный подсчёт расходов пара для клапанов и воздуха.

## Структура проекта

Проект состоит из следующих основных компонентов:

1. **Основной модуль расчётов** — содержит функции для выполнения ввода данных и расчётов.
2. **База данных** — хранит информацию о чертежах и турбинах.
3. **Функции для работы с паром и воздухом** — используют библиотеки для выполнения термодинамических расчётов.
4. **Интерфейс пользователя** — взаимодействие с пользователем через консоль.

### Структура директорий

- `backend/`
  - `app/`
    - `api/`
      - `v1/`
        - `endpoints/` — содержит API-эндпоинты для турбин, клапанов, расчётов и результатов.
    - `core/`
      - `config.py` — конфигурация проекта.
    - `models.py` — модели данных.
    - `schemas.py` — схемы данных.
    - `services/`
      - `valve_calc.py` — бизнес-логика для расчётов клапанов.
    - `tasks.py` — Celery-таски для асинхронных расчётов.
    - `celery_app.py` — инициализация Celery.
    - `main.py` — точка входа FastAPI.
  - `worker.py` — точка входа для Celery worker.
  - `Dockerfile` — конфигурация Docker.
  - `docker-compose.yml` — конфигурация Docker Compose.
  - `requirements.txt` — зависимости проекта.

## Установка

### Предварительные требования:

- Python 3.8 и выше
- PostgreSQL
- Виртуальное окружение (рекомендуется)
- Python Packages из `requirements.txt`

### Шаги установки:

**1. Клонирование репозитория**

   ```bash
   git clone <URL репозитория>
   cd <название репозитория>
   ```
   
#### **2. Создание и активация виртуального окружения**
   - ```python -m venv venv```
   - Linux: **source venv/bin/activate** | Windows: **venv\Scripts\activate**

#### **3. Установка зависимостей**
   - ```pip install -r requirements.txt```

#### **4. Настройка базы данных** 
- Убедитесь, что у вас **установлен PostgreSQL**. 
- **Настройте базу данных** с нужными таблицами и данными. 
- **Конфигурация подключения** к базе данных находится в файле `config.py`.

```Python
SQLALCHEMY_DATABASE_URI = "postgresql+psycopg2://postgres:pass@db:5432/rods"
```

### **Текущий пользовательский процесс**
- Введите название турбины, для которой вы хотите найти чертежи клапанов.
- Выберите ID чертежа из предложенного списка.
- Введите необходимые параметры (давление, температура, количество клапанов и т.д.), чтобы запустить расчёты.
- Программа выведет результаты расчётов для каждого участка клапана, а также параметры отсосов в деаэратор и эжектор уплотнений.

### Основные модули и функции

1. **ValveCalculator** — класс для выполнения всех расчетов, связанных с клапаном и турбиной.
2. **API-эндпоинты** — для взаимодействия с пользователем через веб-интерфейс.
3. **Celery-таски** — для асинхронных расчётов.

### **Пример использования**

- Выберите турбину, например: Turbine A
- Выберите ID чертежа: 1234
- Введите параметры, такие как давление и температура.
- Программа выведет результаты расчёта, например:
  ```console
  Gi: (1000.0, 900.0, 800.0, 700.0, 600.0)
  Pi_in: (10.0, 9.0, 8.0, 7.0, 6.0)
  Ti: (300.0, 290.0, 280.0, 270.0, 260.0)
  Hi: (2800.0, 2700.0, 2600.0, 2500.0, 2400.0)
  deaerator props: (500.0, 150.0, 0.1, 850.0)
  ejector props: (100.0, 80.0, 0.2, 700.0)
  ```

### **Зависимости Python Packages**

Проект использует следующие сторонние библиотеки:
- psycopg2 — для работы с базой данных PostgreSQL.
- PrettyTable — для форматирования и отображения таблиц.
- seuif97 — для термодинамических расчётов свойств пара.

#### Зависимости указаны в файле _requirements.txt._

### Лицензия
Подробности смотрите в файле LICENSE.

### Контакты
Если у вас есть вопросы или предложения, пожалуйста, свяжитесь с нами по электронной почте: ooooooorrrrr@gmail.com или shofer2007@gmail.com.

### SKBT DevTeam: Mikhail, Lev and Pavel
